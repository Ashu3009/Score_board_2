<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel - Test 4</title>
  <style>
    body { font-family: Arial; text-align: center; background: #f0f0f0; }
    .card { background: #fff; padding: 20px; margin: 20px auto; width: 400px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    button { margin: 5px; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #ddd; }
    input { padding: 5px; margin: 5px; }
  </style>
</head>
<body>
  <h1>Admin Panel</h1>

  <div class="card">
    <h2>Game Timer: <span id="main_timer">03:00</span></h2>
    <button onclick="startMain()">Start</button>
    <button onclick="pauseMain()">Pause</button>
    <button onclick="resetMain()">Reset</button>
  </div>

  <div class="card">
    <h2>Penalty Timer: <span id="penalty_timer">00:00</span></h2>
    <button onclick="startPenalty()">Start</button>
    <button onclick="pausePenalty()">Pause</button>
    <button onclick="resetPenalty()">Reset</button>
  </div>
          
  <div class="card">
    <h2>Teams</h2>
    <input id="red_name_input" placeholder="Red Team Name">
    <button onclick="updateTeamName('red')">Update Red</button>
    <br>
    <input id="blue_name_input" placeholder="Blue Team Name">
    <button onclick="updateTeamName('blue')">Update Blue</button>
  </div>

  <div class="card">
    <h2>Scores</h2>
    <button onclick="updateScore('red',1)">Red +1</button>
    <button onclick="updateScore('red',-1)">Red -1</button>
    <span id="score_red">0</span><br>
    <button onclick="updateScore('blue',1)">Blue +1</button>
    <button onclick="updateScore('blue',-1)">Blue -1</button>
    <span id="score_blue">0</span>
  </div>

  <div class="card">
    <h2>Round: <span id="round">1</span></h2>
    <button onclick="nextRound()">Next Round</button>
  </div>

<script>
function formatTime(sec){
  let m = Math.floor(sec/60);
  let s = sec%60;
  return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
}

function update(){
  fetch("/test_4/get_timer/")
    .then(res=>res.json())
    .then(data=>{
      document.getElementById("main_timer").innerText = formatTime(data.main_timer);
      document.getElementById("penalty_timer").innerText = formatTime(data.penalty_timer);
      document.getElementById("score_red").innerText = `${data.team_red_name}: ${data.team_red_score}`;
      document.getElementById("score_blue").innerText = `${data.team_blue_name}: ${data.team_blue_score}`;
      document.getElementById("round").innerText = data.round;
    });
}

function startMain(){ fetch("/test_4/start_main/").then(update); }
function pauseMain(){ fetch("/test_4/pause_main/").then(update); }
function resetMain(){ fetch("/test_4/reset_main/").then(update); }

function startPenalty(){ fetch("/test_4/start_penalty/").then(update); }
function pausePenalty(){ fetch("/test_4/pause_penalty/").then(update); }
function resetPenalty(){ fetch("/test_4/reset_penalty/").then(update); }

function updateScore(team,delta){ fetch(`/test_4/update_score/${team}/${delta}/`).then(update); }
function nextRound(){ fetch("/test_4/next_round/").then(update); }

function updateTeamName(team){
  let name = team==="red" ? document.getElementById("red_name_input").value : document.getElementById("blue_name_input").value;
  fetch(`/test_4/update_team_name/${team}/${name}/`).then(update);
}

setInterval(update,1000);
</script>
</body>
</html>
